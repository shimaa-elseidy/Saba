import{a as V}from"./chunk-7OD7UXMC.js";import{a as b}from"./chunk-IP3FY2TA.js";import"./chunk-CU2TEK6Q.js";import{g as z,l as D}from"./chunk-JKYV32XC.js";import"./chunk-SLPUACWX.js";import"./chunk-MMGRQEJU.js";import"./chunk-Q5MV2RZV.js";import{k,l as E,m as U,w as I}from"./chunk-EJ3EEOXZ.js";import{Cb as d,Kb as i,Lb as o,Mb as m,Qb as x,Vb as f,Wb as l,Zb as y,_a as T,dc as F,eb as c,ec as a,fc as C,gc as h,hc as O,kb as _,mc as P,na as p,nc as M,oa as v,qb as w,vb as g,vc as S}from"./chunk-FHROAHAP.js";import"./chunk-WWX6BADO.js";var N=()=>[1,2,3,4,5];function Y(r,u){if(r&1){let e=x();i(0,"div",15)(1,"p",16),a(2,"You haven't added any tours to your favorites yet."),o(),i(3,"button",17),f("click",function(){p(e);let n=l(2);return v(n.goToTours())}),a(4,"Explore Tours"),o()()}}function R(r,u){r&1&&(i(0,"span",36),m(1,"i",37),o())}function $(r,u){if(r&1){let e=x();i(0,"div",20)(1,"div",21),f("click",function(){let n=p(e).$implicit,s=l(3);return v(s.viewTourDetails(n.id))}),m(2,"img",22),i(3,"div",23)(4,"div",24)(5,"h5",25),a(6),o(),i(7,"button",26),f("click",function(n){let s=p(e).$implicit,j=l(3);return v(j.toggleFavorite(s.id,n))}),m(8,"i",27),o()(),i(9,"p",28),m(10,"i",29),a(11),o(),i(12,"div",30)(13,"span",31),a(14),o(),i(15,"span",31),a(16),o()(),i(17,"div",32),g(18,R,2,0,"span",33),o(),i(19,"p",34),a(20),o(),i(21,"button",35),f("click",function(){let n=p(e).$implicit,s=l(3);return v(s.viewTourDetails(n.id))}),a(22,"Explore"),o()()()()}if(r&2){let e=u.$implicit,t=l(3);c(2),y("alt",e.title),d("src",e.mainImageUrl||"assets/default-tour-image.jpg",T),c(4),C(e.title),c(2),d("ngClass",t.isFavorite(e.id)?"bi-heart-fill":"bi-heart"),c(3),C(e.location),c(3),h("",e.peopleCount," People"),c(2),O("",e.tourDay," Days / ",e.tourNight," Nights"),c(2),d("ngForOf",M(10,N)),c(2),h("Starting From ",e.price," USD")}}function L(r,u){if(r&1&&(i(0,"div",18),g(1,$,23,11,"div",19),o()),r&2){let e=l(2);c(),d("ngForOf",e.favoriteTours)}}function A(r,u){if(r&1&&(i(0,"div",2)(1,"div",3),m(2,"div",4),i(3,"div",5)(4,"video",6),m(5,"source",7),a(6," Your browser does not support the video tag. "),o()(),i(7,"div",8)(8,"div",9)(9,"h1"),a(10,"Your Favorite Tours"),o()()()(),i(11,"div",10)(12,"div",11)(13,"span",12),a(14),o()(),g(15,Y,5,0,"div",13)(16,L,2,1,"div",14),o()()),r&2){let e=l();c(14),h("",e.favoriteTours.length," Favorite Tours"),c(),d("ngIf",e.favoriteTours.length===0),c(),d("ngIf",e.favoriteTours.length>0)}}function B(r,u){if(r&1){let e=x();i(0,"div",38)(1,"h3"),a(2,"Please log in as a user to view your favorite tours."),o(),i(3,"button",39),f("click",function(){p(e);let n=l();return v(n.goToLogin())}),a(4,"Log In"),o()()}}var Z=(()=>{class r{constructor(e,t,n){this.tourService=e,this.router=t,this.toastr=n,this.favoriteTours=[],this.favoriteTourIds=new Set,this.isUser=!1}ngOnInit(){this.checkUserRole(),this.isUser&&this.loadFavoriteTours()}checkUserRole(){let e=localStorage.getItem("userData");if(e)try{let t=JSON.parse(e);this.isUser=t.roleName==="User"}catch(t){console.error("Error parsing userData:",t)}}loadFavoriteTours(){this.tourService.getFavoriteTours().subscribe({next:e=>{this.favoriteTours=e,this.favoriteTourIds=new Set(e.map(t=>t.id))},error:e=>{console.error("Error fetching favorite tours:",e),e.message==="Token not found"?this.toastr.error("Please log in to view favorites.","Unauthorized"):this.toastr.error("Failed to load favorite tours.","Error")}})}isFavorite(e){return this.favoriteTourIds.has(e)}toggleFavorite(e,t){t.stopPropagation(),this.tourService.isTourFavorite(e).subscribe({next:n=>{n?this.tourService.removeTourFromFavorites(e).subscribe({next:()=>{this.favoriteTourIds.delete(e),this.favoriteTours=this.favoriteTours.filter(s=>s.id!==e),this.toastr.success("Tour removed from favorites.","Success")},error:s=>{console.error("Error removing from favorites:",s),this.toastr.error("Failed to remove tour from favorites.","Error")}}):this.tourService.addTourToFavorites(e).subscribe({next:()=>{this.favoriteTourIds.add(e),this.loadFavoriteTours(),this.toastr.success("Tour added to favorites successfully!","Success")},error:s=>{console.error("Error adding to favorites:",s),this.toastr.error("Failed to add tour to favorites.","Error")}})},error:n=>{console.error("Error checking favorite status:",n),n.message==="Token not found"?this.toastr.error("Please log in to add to favorites.","Unauthorized"):this.toastr.error("Failed to check favorite status.","Error")}})}viewTourDetails(e){this.router.navigate(["/tours",e])}goToTours(){this.router.navigate(["/tours"])}goToLogin(){this.router.navigate(["/login"])}static{this.\u0275fac=function(t){return new(t||r)(_(V),_(z),_(b))}}static{this.\u0275cmp=w({type:r,selectors:[["app-favourites-user"]],features:[P([b])],decls:3,vars:2,consts:[["notUser",""],["class","container-fluid p-0",4,"ngIf","ngIfElse"],[1,"container-fluid","p-0"],[1,"filter-background"],[1,"overlay"],[1,"video-background"],["autoplay","","muted","","loop","","playsinline","","preload","auto"],["src","assets/videos/0_Ancient Egypt_Temple_1280x720.mp4","type","video/mp4"],[1,"container"],[1,"tour-title","text-center"],[1,"container","py-5"],[1,"mb-4"],[1,"me-4","fw-bold"],["class","text-center",4,"ngIf"],["class","row",4,"ngIf"],[1,"text-center"],[1,"text-muted"],[1,"btn","btn-primary",3,"click"],[1,"row"],["class","col-md-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-3","mb-4"],[1,"card","h-100",2,"cursor","pointer",3,"click"],[1,"card-img-top",2,"height","200px","object-fit","cover",3,"src","alt"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"card-title","mb-0"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi",3,"ngClass"],[1,"card-text","text-muted"],[1,"bi","bi-geo-alt","me-1"],[1,"d-flex","gap-2","mb-2"],[1,"badge","bg-light","text-dark"],[1,"d-flex","align-items-center","mb-2"],["class","text-warning me-1",4,"ngFor","ngForOf"],[1,"card-text","text-primary","fw-bold"],[1,"btn","btn-outline-primary","w-100",3,"click"],[1,"text-warning","me-1"],[1,"bi","bi-star-fill"],[1,"container","py-5","text-center"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(t,n){if(t&1&&g(0,A,17,3,"div",1)(1,B,5,0,"ng-template",null,0,S),t&2){let s=F(2);d("ngIf",n.isUser)("ngIfElse",s)}},dependencies:[I,k,E,U,D],styles:[".container-fluid[_ngcontent-%COMP%]{font-family:Barlow,sans-serif}.filter-background[_ngcontent-%COMP%]{width:100%;height:40vh;position:relative;display:flex;margin-bottom:20px;align-items:center;overflow:hidden}.video-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:0}.video-background[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0009;z-index:1}.filter-background[_ngcontent-%COMP%] > .container[_ngcontent-%COMP%]{z-index:2}.tour-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:15px;color:#fff;font-size:2.5rem;font-weight:700;text-transform:uppercase;letter-spacing:2px;text-shadow:2px 2px 4px rgba(0,0,0,.5);animation:_ngcontent-%COMP%_fadeInDown 1.5s ease-in-out forwards}@keyframes _ngcontent-%COMP%_fadeInDown{0%{opacity:0;transform:translateY(-50px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{border:none;border-radius:10px;box-shadow:0 2px 10px #0000001a;transition:transform .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.card-img-top[_ngcontent-%COMP%]{border-top-left-radius:10px;border-top-right-radius:10px;height:200px;object-fit:cover}.card-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#333}.card-text[_ngcontent-%COMP%]{font-size:.9rem}@media (min-width: 768px){.col-md-3[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.1rem}.col-md-3[_ngcontent-%COMP%]   .card-text[_ngcontent-%COMP%]{font-size:.85rem}.col-md-3[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.75rem}}.btn-outline-primary[_ngcontent-%COMP%]{border-color:#0d62e2;color:#0d62e2;transition:all .3s ease}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#0d62e2;color:#fff}.btn-outline-danger[_ngcontent-%COMP%]{border-color:#dc3545;color:#dc3545}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;color:#fff}.btn-primary[_ngcontent-%COMP%]{padding:5px 10px;font-size:.85rem;border-radius:4px}@media (max-width: 768px){.card[_ngcontent-%COMP%]{margin:0 15px}.filter-background[_ngcontent-%COMP%]{height:400px}.btn-primary[_ngcontent-%COMP%]{font-size:.8rem;padding:4px 8px}}"]})}}return r})();export{Z as FavouritesUserComponent};
