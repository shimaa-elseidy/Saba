import{a as q}from"./chunk-LQG3IROI.js";import{a as K}from"./chunk-AXM7N3CA.js";import{a as Z}from"./chunk-HZXTCNW7.js";import{a as G}from"./chunk-IP3FY2TA.js";import{A as H,c as W,f as $,k as R}from"./chunk-5ZW25HYA.js";import"./chunk-CU2TEK6Q.js";import{g as N,h as B}from"./chunk-JKYV32XC.js";import"./chunk-SLPUACWX.js";import"./chunk-MMGRQEJU.js";import"./chunk-Q5MV2RZV.js";import{k as j,l as F,m as Y,s as A,w as L}from"./chunk-EJ3EEOXZ.js";import{C,Cb as d,G as M,Kb as o,Lb as r,Qb as P,T as k,Vb as l,Wb as p,_a as S,ca as f,eb as a,ec as i,fc as x,gc as D,jc as T,kc as I,lc as E,m as b,na as g,oa as m,oc as u,qb as U,rc as z,tc as V,vb as O}from"./chunk-FHROAHAP.js";import{a as v,b as y}from"./chunk-WWX6BADO.js";var h=s=>({active:s}),Q=s=>({"active-user":s});function X(s,w){if(s&1){let e=P();o(0,"div",15)(1,"div",16)(2,"div",17)(3,"img",18),l("error",function(t){g(e);let c=p();return m(c.handleImageError(t))}),r()(),o(4,"div",19)(5,"button",20),l("click",function(){let t=g(e).$implicit,c=p();return m(c.openChat(t))}),o(6,"i",21),i(7,"chat"),r()(),o(8,"button",22),l("click",function(){let t=g(e).$implicit,c=p();return m(c.showDeleteConfirmation(t))}),o(9,"i",21),i(10,"close"),r()()()(),o(11,"div",23)(12,"h5",24),i(13),r(),o(14,"p",25),i(15),r(),o(16,"p",26),i(17),z(18,"date"),r()()()}if(s&2){let e=w.$implicit,n=p();d("ngClass",u(8,Q,e.status==="active")),a(3),d("src",n.getSafeImageUrl(e.profilePicture),S),a(10),x(e.name),a(2),x(e.email),a(2),x(V(18,5,e.createdAt,"yyyy-MM-dd HH:mm:ss"))}}function ee(s,w){if(s&1){let e=P();o(0,"div",27),l("click",function(){g(e);let t=p();return m(t.closeModal())}),o(1,"div",28),l("click",function(t){return g(e),m(t.stopPropagation())}),o(2,"h3"),i(3,"Confirm Deletion"),r(),o(4,"p"),i(5),r(),o(6,"div",29)(7,"button",30),l("click",function(){g(e);let t=p();return m(t.confirmDelete())}),i(8,"Yes, I'm sure"),r(),o(9,"button",31),l("click",function(){g(e);let t=p();return m(t.closeModal())}),i(10,"No, cancel"),r()()()()}if(s&2){let e=p();a(5),D("Are you sure you want to delete ",e.userToDelete==null?null:e.userToDelete.name,"?")}}var ue=(()=>{class s{constructor(){this.searchTerm="",this.selectedStatus="all",this.usersCount=0,this.users=[],this.defaultImage="https://via.placeholder.com/40",this.showModal=!1,this.userToDelete=null,this.dashboardService=f(K),this.userService=f(Z),this.toastr=f(G),this.router=f(N),this.chatSelectionService=f(q)}ngOnInit(){this.getUsersCount(),this.loadUsers()}get filteredUser(){return this.users?this.users.filter(e=>{let n=this.searchTerm?.toLowerCase()||"",t=e.name?.toLowerCase()||"",c=e.email?.toLowerCase()||"",_=n===""||t.includes(n)||c.includes(n),J=this.selectedStatus==="all"||e.status===this.selectedStatus;return _&&J}):[]}filterUsers(e){this.selectedStatus=e}openChat(e){e&&e.userID?(this.chatSelectionService.setSelectedUserId(e.userID),this.router.navigate(["/dashboard/chat"])):this.toastr.error("User ID is missing.")}showDeleteConfirmation(e){if(e&&e.userID){if(e.isDeleted){this.toastr.warning("This user is already deleted.");return}this.userToDelete=e,this.showModal=!0}else this.toastr.error("User ID is missing.")}confirmDelete(){this.userToDelete&&this.userToDelete.userID&&this.userService.getUserById(this.userToDelete.userID).subscribe({next:e=>{if(e.isDeleted){this.toastr.warning("This user is already deleted."),this.closeModal();return}this.userService.deleteUserById(this.userToDelete.userID).subscribe({next:()=>{this.users=this.users.filter(n=>n.userID!==this.userToDelete.userID),this.toastr.success(`User ${this.userToDelete.name} has been deleted.`),this.closeModal()},error:n=>{this.toastr.error("Error deleting user. Please try again."),this.closeModal()}})},error:e=>{this.toastr.error("Error fetching user data before delete."),this.closeModal()}})}closeModal(){this.showModal=!1,this.userToDelete=null}loadMore(){console.log("Load more users")}getUsersCount(){this.dashboardService.getUsersCount().pipe(M(1),k(),C(e=>(console.error("Error fetching users count:",e),b(0)))).subscribe(e=>{this.usersCount=e})}loadUsers(){this.userService.getAllUsers().pipe(M(1),C(e=>(console.error("Error loading users:",e),b([])))).subscribe(e=>{this.users=e.map(n=>{let t="active";return n.isDeleted?t="deleted":n.isBanned?t="blocked":n.isEmailConfirmed||(t="pending"),y(v({},n),{status:t})}),console.log("Loaded Users:",this.users)})}getSafeImageUrl(e){let n="../../../assets/avatar.jpg";return e?/^[a-zA-Z0-9+/=]{100,}$/.test(e)?e.startsWith("/9j/")?`data:image/jpeg;base64,${e}`:e.startsWith("iVBORw0KGgo")?`data:image/png;base64,${e}`:`data:image/jpeg;base64,${e}`:e.startsWith("http://")||e.startsWith("https://")?e:n:n}handleImageError(e){let n=e.target;n.src=this.defaultImage}static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275cmp=U({type:s,selectors:[["app-user-management"]],decls:35,vars:20,consts:[[1,"user-management"],[1,"header"],[1,"left-section"],[1,"customer"],[1,"right-section"],["routerLink","/dashboard/create-new-user",1,"create-btn"],[1,"search-container"],["type","text","placeholder","Search for user...",3,"ngModelChange","ngModel"],[1,"material-icons","search-icon"],[1,"user-management-container"],[1,"filter-buttons"],[1,"btn",3,"click","ngClass"],[1,"user-grid"],["class","user-card",3,"ngClass",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"user-card",3,"ngClass"],[1,"user-card-header"],[1,"user-image-container"],["alt","User Image",1,"user-image",3,"error","src"],[1,"user-actions"],["title","Chat with user",1,"action-btn","chat-btn",3,"click"],[1,"material-icons"],["title","Delete user",1,"action-btn","delete-btn",3,"click"],[1,"user-info"],[1,"user-name"],[1,"user-email"],[1,"user-date"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-buttons"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-secondary",3,"click"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span"),i(5,"All Users"),r(),o(6,"strong"),i(7),r()(),o(8,"div",3)(9,"span"),i(10,"Customer"),r(),o(11,"strong"),i(12),r()()(),o(13,"div",4)(14,"button",5),i(15,"+ Create New User"),r(),o(16,"div",6)(17,"input",7),E("ngModelChange",function(_){return I(t.searchTerm,_)||(t.searchTerm=_),_}),r(),o(18,"i",8),i(19,"search"),r()()()(),o(20,"div",9)(21,"div",10)(22,"button",11),l("click",function(){return t.filterUsers("all")}),i(23,"All Customers"),r(),o(24,"button",11),l("click",function(){return t.filterUsers("active")}),i(25,"Active Users"),r(),o(26,"button",11),l("click",function(){return t.filterUsers("blocked")}),i(27,"Blocked Users"),r(),o(28,"button",11),l("click",function(){return t.filterUsers("pending")}),i(29,"Pending Users"),r(),o(30,"button",11),l("click",function(){return t.filterUsers("deleted")}),i(31,"Deleted Users"),r()(),o(32,"div",12),O(33,X,19,10,"div",13),r()(),O(34,ee,11,1,"div",14),r()),n&2&&(a(7),x(t.usersCount.allUsers),a(5),x(t.usersCount.customer),a(5),T("ngModel",t.searchTerm),a(5),d("ngClass",u(10,h,t.selectedStatus==="all")),a(2),d("ngClass",u(12,h,t.selectedStatus==="active")),a(2),d("ngClass",u(14,h,t.selectedStatus==="blocked")),a(2),d("ngClass",u(16,h,t.selectedStatus==="pending")),a(2),d("ngClass",u(18,h,t.selectedStatus==="deleted")),a(3),d("ngForOf",t.filteredUser),a(),d("ngIf",t.showModal))},dependencies:[H,W,$,R,F,L,j,Y,A,B],styles:['.user-management[_ngcontent-%COMP%]{width:90%;max-width:1200px;margin:40px auto 100px;padding:25px;background-color:#f0f4ff;border-radius:20px;box-shadow:0 4px 20px #00000014;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.user-management-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;flex-wrap:wrap}.left-section[_ngcontent-%COMP%]{display:flex;gap:20px}.customer[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:10px 20px;border-radius:25px;font-size:14px;font-weight:500;color:#64748b;text-align:center}.customer[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:18px;color:#2d60ff}.right-section[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:center}.create-btn[_ngcontent-%COMP%]{background-color:#2d60ff;color:#fff;border:2px solid #2D60FF;padding:10px 20px;border-radius:25px;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden;z-index:1;animation:_ngcontent-%COMP%_pulse 2s infinite}.create-btn[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(45deg,#2d60ff,#00c6ff);opacity:0;z-index:-1;transition:opacity .3s ease}.create-btn[_ngcontent-%COMP%]:hover{background-color:#1a4fd4;transform:translateY(-3px);box-shadow:0 8px 15px #2d60ff4d}.create-btn[_ngcontent-%COMP%]:hover:after{opacity:1}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 #2d60ff66}70%{box-shadow:0 0 0 10px #2d60ff00}to{box-shadow:0 0 #2d60ff00}}input[type=text][_ngcontent-%COMP%]{padding:10px 35px 10px 15px;border:1px solid #e2e8f0;border-radius:25px;font-size:14px;width:100%;transition:all .3s ease}input[_ngcontent-%COMP%]::placeholder{color:#64748b}input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2d60ff}.allUsers[_ngcontent-%COMP%]{background-color:#fff;padding:30px;border-radius:16px;box-shadow:0 4px 15px #0000000a;margin-top:25px}.filter-buttons[_ngcontent-%COMP%]{margin-top:20px;display:flex;gap:15px;justify-content:center;flex-wrap:wrap;margin-bottom:20px}.filter-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff;border:2px solid #007bff;color:#007bff;padding:10px 20px;border-radius:30px;cursor:pointer;font-weight:500;font-size:13px;transition:all .3s ease;position:relative;overflow:hidden;z-index:1;white-space:nowrap}.filter-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:#007bff;transition:all .3s ease;z-index:-1}.filter-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#fff}.filter-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:before{left:0;animation:_ngcontent-%COMP%_buttonSlide .3s forwards}@keyframes _ngcontent-%COMP%_buttonSlide{0%{left:-100%}to{left:0}}@keyframes _ngcontent-%COMP%_ripple{0%{transform:scale(0);opacity:.5}20%{transform:scale(25);opacity:.3}to{opacity:0;transform:scale(40)}}.filter-buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border-color:#007bff;box-shadow:0 4px 10px #007bff4d;transform:translateY(-2px)}.search-bar[_ngcontent-%COMP%]{margin-bottom:20px}.search-input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:5px}.user-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.user-row[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;border-bottom:1px solid #ddd}.user-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-name[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin:0}.user-email[_ngcontent-%COMP%]{font-size:14px;color:#666;margin:5px 0}.user-date[_ngcontent-%COMP%]{font-size:12px;color:#999}.action-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background-color:#f0f0f0;border:none;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 5px #0000001a}.action-btn[_ngcontent-%COMP%]:hover{transform:scale(1.15) rotate(5deg);box-shadow:0 4px 8px #0003}.action-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:all .3s ease}.action-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_iconPulse .5s ease}.chat-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.chat-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.delete-btn[_ngcontent-%COMP%]{background-color:#ff4d4d;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#ff1a1a}@keyframes _ngcontent-%COMP%_iconPulse{0%{transform:scale(1)}50%{transform:scale(1.3)}to{transform:scale(1)}}.icons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer}.user-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px;margin-top:25px}.user-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px 15px;border:2px solid #e6e6e6;border-radius:12px;background-color:#fff;box-shadow:0 3px 10px #00000014;transition:all .3s ease;position:relative;overflow:hidden;animation-name:_ngcontent-%COMP%_cardAppear;animation-duration:.5s;animation-fill-mode:both;animation-timing-function:ease-out}@keyframes _ngcontent-%COMP%_cardAppear{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.user-card[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.user-card[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.user-card[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}.user-card[_ngcontent-%COMP%]:nth-child(4){animation-delay:.4s}.user-card[_ngcontent-%COMP%]:nth-child(5){animation-delay:.5s}.user-card[_ngcontent-%COMP%]:nth-child(6){animation-delay:.6s}.user-card[_ngcontent-%COMP%]:nth-child(7){animation-delay:.7s}.user-card[_ngcontent-%COMP%]:nth-child(8){animation-delay:.8s}.user-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 15px #0000001a}.user-card.active-user[_ngcontent-%COMP%]{border-color:#007bff;border-left:5px solid #007bff}.user-card[_ngcontent-%COMP%]:not(.active-user){border:2px dashed #ff6b6b;animation:_ngcontent-%COMP%_borderPulse 2s infinite}@keyframes _ngcontent-%COMP%_borderPulse{0%{border-color:#ff6b6b}50%{border-color:#ffb347}to{border-color:#ff6b6b}}.user-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;width:100%;margin-bottom:15px}.user-image-container[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;overflow:hidden;border:3px solid #f0f4ff;box-shadow:0 4px 10px #0000001a;transition:all .3s ease}.user-card[_ngcontent-%COMP%]:hover   .user-image-container[_ngcontent-%COMP%]{transform:scale(1.05);border-color:#007bff}.user-info[_ngcontent-%COMP%]{text-align:left;margin-bottom:10px;width:100%}.user-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:#007bff;font-size:20px}.icons[_ngcontent-%COMP%]{display:flex;gap:10px}.icons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:#64748b;background-color:#f8fafc;padding:8px;border-radius:8px;display:inline-flex;justify-content:center;align-items:center;width:32px;height:32px;transition:all .3s ease}.icons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{background-color:#2d60ff;color:#fff;transform:scale(1.1)}.icons[_ngcontent-%COMP%]   i.bi-chat-dots[_ngcontent-%COMP%]:hover{background-color:#10b981}.icons[_ngcontent-%COMP%]   i.bi-x-circle[_ngcontent-%COMP%]:hover{background-color:#ef4444}.see-more[_ngcontent-%COMP%]{margin:25px auto 0;background-color:#2d60ff;color:#fff;padding:12px 40px;border:none;border-radius:8px;cursor:pointer;display:block;text-align:center;font-weight:600;transition:all .3s ease}.see-more[_ngcontent-%COMP%]:hover{background-color:#1a4fd4;transform:translateY(-1px)}h1[_ngcontent-%COMP%]{font-weight:700;color:#2d3748}@media (max-width: 1024px){.user-management[_ngcontent-%COMP%]{width:calc(100% - 100px);margin:30px 0 80px 80px;padding:20px}.user-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(280px,1fr))}.filter-buttons[_ngcontent-%COMP%]{flex-wrap:wrap}}@media (max-width: 768px){.user-management[_ngcontent-%COMP%]{width:calc(100% - 90px);margin-left:80px;margin-top:20px;padding:15px}.header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;text-align:center}.left-section[_ngcontent-%COMP%]{justify-content:center;width:100%}.customer[_ngcontent-%COMP%]{flex:1;min-width:140px;padding:15px}.right-section[_ngcontent-%COMP%]{justify-content:center;width:100%;flex-wrap:wrap;gap:10px}.create-btn[_ngcontent-%COMP%]{width:100%;max-width:250px}.user-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:15px}.filter-buttons[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap;gap:10px}}@media (max-width: 480px){.user-management[_ngcontent-%COMP%]{width:calc(100% - 90px);margin:10px 0 50px 80px;padding:15px;border-radius:15px}.customer[_ngcontent-%COMP%]{flex-direction:column;text-align:center;padding:12px;min-width:120px}.customer[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-left:0;margin-top:5px}.user-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center;align-items:center;padding:15px}.user-info[_ngcontent-%COMP%]{align-items:center;text-align:center}.icons[_ngcontent-%COMP%]{flex-direction:row;justify-content:center;gap:15px;margin-left:0;margin-top:15px}input[type=text][_ngcontent-%COMP%]{width:100%;max-width:300px}.user-cards[_ngcontent-%COMP%]{grid-template-columns:1fr;max-height:400px}.filter-buttons[_ngcontent-%COMP%]{gap:5px;flex-wrap:wrap}.filter-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 12px;font-size:11px;margin-bottom:5px}}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:16px;width:450px;max-width:90%;box-shadow:0 10px 40px #0003;text-align:center;animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:15px;font-size:1.6rem;color:#2d3748;font-weight:600}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:25px;font-size:1rem;color:#64748b;line-height:1.5}.modal-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px}.btn[_ngcontent-%COMP%]{padding:12px 25px;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all .3s ease;min-width:120px}.btn-danger[_ngcontent-%COMP%]{background-color:#ef4444;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc2626;transform:translateY(-1px)}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268;transform:translateY(-1px)}.no-users[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#64748b;margin:20px 0}.search-container[_ngcontent-%COMP%]{position:relative;width:250px}.search-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#64748b;font-size:18px;transition:all .3s ease}input[type=text][_ngcontent-%COMP%]:focus + .search-icon[_ngcontent-%COMP%]{color:#2d60ff}']})}}return s})();export{ue as UserManagementComponent};
