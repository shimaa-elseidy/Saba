import{a as R}from"./chunk-AXM7N3CA.js";import{A as z,c as A,f as F,k as j}from"./chunk-5ZW25HYA.js";import{l as I}from"./chunk-JKYV32XC.js";import{a as B}from"./chunk-SLPUACWX.js";import"./chunk-MMGRQEJU.js";import{c as k}from"./chunk-Q5MV2RZV.js";import{l as T,w as W}from"./chunk-EJ3EEOXZ.js";import{C as f,Cb as m,Fb as w,G as u,Kb as n,Lb as e,Mb as p,T as x,Vb as g,Wb as S,Y as M,ba as y,eb as o,ec as i,fc as l,gc as E,hc as D,jc as P,kb as b,kc as _,lc as C,m as h,qb as v,vb as O}from"./chunk-FHROAHAP.js";import"./chunk-WWX6BADO.js";var L=(()=>{class s{constructor(t){this.http=t,this.baseUrl=B.apiUrl}getAllPayments(){return this.http.get(`${this.baseUrl}/Payments/get-payments`)}getAllDashStats(){return this.http.get(`${this.baseUrl}/Payments/dashboard-stats`)}static{this.\u0275fac=function(r){return new(r||s)(y(k))}}static{this.\u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();function $(s,U){if(s&1&&(n(0,"tr")(1,"td",25),p(2,"input",17),e(),n(3,"td"),i(4),e(),n(5,"td"),i(6),e(),n(7,"td"),i(8),e(),n(9,"td"),i(10),e(),n(11,"td"),i(12),e(),n(13,"td"),i(14),e()()),s&2){let t=U.$implicit,r=S();o(4),l(t.username),o(2),l(t.userEmail),o(2),l(t.gateway),o(2),l(t.paymentDate),o(2),l(t.amount),o(),w(r.getStatusClass(t.status)),o(),E(" ",t.status," ")}}var tt=(()=>{class s{constructor(t,r){this.dashboardService=t,this.paymentService=r,this.myWalletBalance=0,this.allRefunds=0,this.paymentLastWeek=0,this.currentPage=1,this.pageSize=10,this.totalEntries=0,this.allTransactions=[],this.startDate="",this.endDate="",this.transactions=[],this.filteredTransactions=[]}getStatusClass(t){switch(t){case"Completed":return"completed";case"Pending":return"pending";case"Failed":return"failed";case"Rejected":return"rejected";case"On progress":return"on-progress";case"Refund":return"refund";default:return""}}ngOnInit(){this.fetchDashStats(),this.fetchAllPayments()}fetchAllPayments(){this.paymentService.getAllPayments().pipe(u(1),x(t=>{console.log("Fetched All Payments:",t),this.allTransactions=t,this.totalEntries=t.length,this.updateDisplayedTransactions()}),f(t=>(console.error("Error fetching payments:",t),h([])))).subscribe()}updateDisplayedTransactions(){let t=(this.currentPage-1)*this.pageSize,r=t+this.pageSize,a=this.startDate&&this.endDate?this.filteredTransactions:this.allTransactions;this.transactions=a.slice(t,r)}filterByDate(){this.startDate&&this.endDate?(this.filteredTransactions=this.allTransactions.filter(t=>{let r=new Date(t.paymentDate),a=new Date(this.startDate),d=new Date(this.endDate);return r>=a&&r<=d}),this.totalEntries=this.filteredTransactions.length,this.currentPage=1,this.updateDisplayedTransactions()):(this.filteredTransactions=[],this.totalEntries=this.allTransactions.length,this.updateDisplayedTransactions())}previousPage(){this.currentPage>1&&(this.currentPage--,this.updateDisplayedTransactions())}nextPage(){this.currentPage<this.getTotalPages()&&(this.currentPage++,this.updateDisplayedTransactions())}getTotalPages(){return Math.ceil(this.totalEntries/this.pageSize)}getDisplayedEntries(){let t=(this.currentPage-1)*this.pageSize+1,r=Math.min(this.currentPage*this.pageSize,this.totalEntries);return`${t} to ${r} of ${this.totalEntries}`}fetchDashStats(){this.paymentService.getAllDashStats().pipe(u(1),x(t=>{console.log("Fetched Dashboard Stats:",t),this.myWalletBalance=this.extractCurrencyValue(t.myWalletBalance),this.allRefunds=this.extractCurrencyValue(t.allRefunds),this.paymentLastWeek=this.extractCurrencyValue(t.paymentLastWeek)}),f(t=>(console.error("Error fetching dashboard stats:",t),h({myWalletBalance:"$0",allRefunds:"$0",paymentLastWeek:"$0"})))).subscribe()}extractCurrencyValue(t){return Number(t.replace(/[^0-9.]/g,""))}static{this.\u0275fac=function(r){return new(r||s)(b(R),b(L))}}static{this.\u0275cmp=v({type:s,selectors:[["app-withdrawals"]],decls:74,vars:10,consts:[[1,"container","overview"],[1,""],[1,"stats"],[1,"stat-card"],[1,"bi","bi-cash-stack"],[1,"bi","bi-megaphone-fill"],[1,"bi","bi-handbag-fill"],[1,"filters"],[1,"btn"],[1,"btn","btn-primary"],[1,"d-flex","align-items-center"],["for","start",1,"me-1"],["type","date","id","start",3,"ngModelChange","change","ngModel"],["for","end",1,"me-1"],["type","date","id","end",3,"ngModelChange","change","ngModel"],[1,"table-responsive"],[1,"table"],["type","checkbox"],[4,"ngFor","ngForOf"],["colspan","7",1,"table-footer"],[1,"d-flex","justify-content-between","align-items-center"],[1,"pagination-controls"],[1,"btn","btn-sm","btn-outline-primary","me-2",3,"click","disabled"],[1,"page-info"],[1,"btn","btn-sm","btn-outline-primary","ms-2",3,"click","disabled"],[1,"checkbox-cell"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h4"),i(6,"My Wallet Balance"),e(),n(7,"h2"),i(8),e()(),p(9,"i",4),e(),n(10,"div",3)(11,"div")(12,"h4"),i(13,"My Refunds"),e(),n(14,"h2"),i(15),e()(),p(16,"i",5),e(),n(17,"div",3)(18,"div")(19,"h4"),i(20,"Payments Last Week"),e(),n(21,"h2"),i(22),e()(),p(23,"i",6),e()()(),n(24,"div",7)(25,"button",8),i(26,"Bulk Actions \u25BC"),e(),n(27,"button",9),i(28,"Apply"),e(),n(29,"div",10)(30,"label",11),i(31,"Start Date:"),e(),n(32,"input",12),C("ngModelChange",function(c){return _(a.startDate,c)||(a.startDate=c),c}),g("change",function(){return a.filterByDate()}),e()(),n(33,"div",10)(34,"label",13),i(35,"End Date:"),e(),n(36,"input",14),C("ngModelChange",function(c){return _(a.endDate,c)||(a.endDate=c),c}),g("change",function(){return a.filterByDate()}),e()(),n(37,"button",9),i(38,"Filter"),e(),n(39,"button",9),i(40,"Export to CSV"),e(),n(41,"button",8),i(42,"Show / Hide columns"),e()(),n(43,"div",15)(44,"table",16)(45,"thead")(46,"tr")(47,"th"),p(48,"input",17),e(),n(49,"th"),i(50,"Username"),e(),n(51,"th"),i(52,"User Email"),e(),n(53,"th"),i(54,"Gateway"),e(),n(55,"th"),i(56,"Payment Date"),e(),n(57,"th"),i(58,"Amount"),e(),n(59,"th"),i(60,"Status"),e()()(),n(61,"tbody"),O(62,$,15,8,"tr",18),e(),n(63,"tfoot")(64,"tr")(65,"td",19)(66,"div",20)(67,"div",21)(68,"button",22),g("click",function(){return a.previousPage()}),i(69," Previous "),e(),n(70,"span",23),i(71),e(),n(72,"button",24),g("click",function(){return a.nextPage()}),i(73," Next "),e()()()()()()()()()),r&2&&(o(8),l(a.myWalletBalance),o(7),l(a.allRefunds),o(7),l(a.paymentLastWeek),o(10),P("ngModel",a.startDate),o(4),P("ngModel",a.endDate),o(26),m("ngForOf",a.transactions),o(6),m("disabled",a.currentPage===1),o(3),D("Page ",a.currentPage," of ",a.getTotalPages(),""),o(),m("disabled",a.currentPage===a.getTotalPages()))},dependencies:[W,T,I,z,A,F,j],styles:['@charset "UTF-8";.overview[_ngcontent-%COMP%]{width:90%;background-color:#ffffffb3;margin:20px auto;border-radius:15px;padding:25px}.stats[_ngcontent-%COMP%]{width:100%;display:flex;gap:120px}.stat-card[_ngcontent-%COMP%]{background:#fff;display:flex;justify-content:space-between;align-items:center;padding:10px 15px;width:320px;border-radius:10px;box-shadow:0 4px 6px #0000001a;transition:.3s}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.stat-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px;font-weight:400;color:#718ebf}.stat-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700}.stat-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-top:10px;font-size:45px;color:#2d60ff}.filters[_ngcontent-%COMP%]{display:flex;width:100%;margin:20px 0;gap:21px}.filters[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 12px;background-color:#f5f5f5;border:1px solid #dcdcdc;border-radius:5px;cursor:pointer}.filters[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2d60ff;color:#fff;border-radius:8px;padding:2px 8px}.filters[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #dcdcdc;border-radius:5px}td[_ngcontent-%COMP%]{padding:12px;text-align:left}td.completed[_ngcontent-%COMP%]{color:green;font-weight:700}td.failed[_ngcontent-%COMP%]{color:red;font-weight:700}td.pending[_ngcontent-%COMP%]{color:orange;font-weight:700}td.on-progress[_ngcontent-%COMP%]{color:#00f;font-weight:700}td.refund[_ngcontent-%COMP%]{color:purple;font-weight:700}.table-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.table-responsive[_ngcontent-%COMP%]{width:100%;margin:15px 0;background:#fff;padding:15px;border-radius:10px;box-shadow:0 2px 10px #0000001a;overflow-x:auto}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;white-space:nowrap}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700;color:#6c757d;border-bottom:2px solid #e9ecef}.table-responsive[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #e9ecef}.table-responsive[_ngcontent-%COMP%]   td.completed[_ngcontent-%COMP%]{color:#37b853;font-weight:700}.table-responsive[_ngcontent-%COMP%]   td.failed[_ngcontent-%COMP%]{color:#a55f77;font-weight:700}.table-responsive[_ngcontent-%COMP%]   td.pending[_ngcontent-%COMP%]{color:#ffb321;font-weight:700}.table-responsive[_ngcontent-%COMP%]   td.on-progress[_ngcontent-%COMP%]{color:#00f;font-weight:700}.table-responsive[_ngcontent-%COMP%]   td.refund[_ngcontent-%COMP%]{color:#007aff;font-weight:700}.table-responsive[_ngcontent-%COMP%]   td.rejected[_ngcontent-%COMP%]{color:#eb4d4d;font-weight:700}.table-responsive[_ngcontent-%COMP%]   .table-footer[_ngcontent-%COMP%]{text-align:left;padding:15px;font-size:14px;color:#555}@media (max-width: 992px){.table-responsive[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{width:90%;margin:15px auto}}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{width:90%;padding:10px;border-radius:5px;margin:15px auto 30px}}@media (max-width: 480px){.table-responsive[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{padding:5px}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]   .dashboard[_ngcontent-%COMP%]{margin-top:60px;margin-left:40px;width:calc(100% - 60px);overflow-x:hidden}.table-responsive[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{flex-direction:column;align-items:center;width:100%;gap:20px}.table-responsive[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{width:90%}}']})}}return s})();export{tt as WithdrawalsComponent};
